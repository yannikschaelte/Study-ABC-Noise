v4: sparse
v5: estimate noise
